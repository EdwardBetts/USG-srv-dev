{% extends "wintersession/base.html" %}
{% load render_table from django_tables2 %}
{% load url from future %}
{% load static %}
{% get_static_prefix as STATIC_PREFIX %}
{% load verbatim %}

{% block head %}
    <title>Courses - Wintersession 2015</title>
    <link rel="stylesheet" type="text/css" href="{{ STATIC_PREFIX }}wintersession/courses.css" />
{% endblock %}

{% block banner %}
    Course Listing & Registration
{% endblock %}

{% block menu %}
    <li id='pg721251121132996039'><a href='{% url 'home' %}'>Home</a></li>
    <li id='active'><a href='{% url 'courses' %}'>Courses</a></li>
    <li id='pg263206575262786359'><a href='{% url 'enroll' %}'>Enroll</a></li>
    <li id='pg276867464249989051'><a href='{% url 'teach' %}'>Teach</a></li>
    <li id='pg373026107483497366'><a href='{% url 'about' %}'>About</a></li>
{% endblock %}

{% block content %}
{% verbatim %}
<script type="text/x-handlebars" data-template-name="courses">
    <div id="courses_left">
        <h1>My Courses<span>{{ registrations.length }}</span></h1>
        <div id="course_schedule_wrap">
            <div id="course_schedule_labels_top">
                <div class="course_schedule_labels_top_day">M</div>
                <div class="course_schedule_labels_top_day">T</div>
                <div class="course_schedule_labels_top_day">W</div>
                <div class="course_schedule_labels_top_day">Th</div>
                <div class="course_schedule_labels_top_day">F</div>
            </div>
            <div id="course_schedule_labels_left">
                10a<br/>
                11a<br/>
                12p<br/>
                1p<br/>
                2p<br/>
                3p<br/>
                4p<br/>
                5p<br/>
                6p<br/>
                7p<br/>
                8p<br/>
                9p<br/>
                10p<br/>
            </div>
            <div id="course_schedule">
                <div class="course_schedule_day">
                    {{ #each r in registrations }}
                    {{ #each time in r.section.schedule.[0] }}
                    {{ courseScheduleItem r.section.course.title time.[0] time.[1] }}
                    {{ /each }}
                    {{ /each }}
                </div>
                <div class="course_schedule_day">
                    {{ #each r in registrations }}
                    {{ #each time in r.section.schedule.[1] }}
                    {{ courseScheduleItem r.section.course.title time.[0] time.[1] }}
                    {{ /each }}
                    {{ /each }}
                </div>
                <div class="course_schedule_day">
                    {{ #each r in registrations }}
                    {{ #each time in r.section.schedule.[2] }}
                    {{ courseScheduleItem r.section.course.title time.[0] time.[1] }}
                    {{ /each }}
                    {{ /each }}
                </div>
                <div class="course_schedule_day">
                    {{ #each r in registrations }}
                    {{ #each time in r.section.schedule.[3] }}
                    {{ courseScheduleItem r.section.course.title time.[0] time.[1] }}
                    {{ /each }}
                    {{ /each }}
                </div>
                <div class="course_schedule_day">
                    {{ #each r in registrations }}
                    {{ #each time in r.section.schedule.[4] }}
                    {{ courseScheduleItem r.section.course.title time.[0] time.[1] }}
                    {{ /each }}
                    {{ /each }}
                </div>
            </div>
        </div>
        <div id="course_list">
            {{ #each registration in sortedRegistrations }}
                <section class="course_mini_item">
                    <div class="course_info">
                        <h1>{{ registration.section.course.title }}</h1>
                    </div>
                    <div class="course_section">
                        {{ registration.section.schedule_string }}
                        <btn class="course_section_remove" {{ action "unregisterSection" registration.section }}>x</btn>
                    </div>
                </section>
            {{ /each }}
        </div>
    </div>
    <div id="courses_right">
        <h1>Course Catalog<span>{{ filteredContent.length }}</span></h1>
        <div id="courses_list_filter">
            Filter
            {{ input type='text' value=filterValue placeholder='Course title ...' action='doFilter' }}
            <label><input type="checkbox">Starred</label>
        </div>
        <div id="course_catalog">
            {{ #each course in filteredContent }}
                <section {{ bind-attr class=":course_item course.isRegistered course.cancelled:is-cancelled" }}>
                    <div class="course_info">
                        <btn class="course_star">*</btn>
                        <h1>{{ course.title }}</h1>
                        <h2>Instructors: {{ course.instructors }}</h2>
                        {{{ course.description }}}
                    </div>

                    {{ #each section in course.sections }}
                    <div {{ bind-attr class=":course_section section.isRegistered section.isConflicting" }}>
                        {{ section.schedule_string }}

                        {{ #if section.isConflicting }}
                            <span class="conflict-text">{{ section.conflictText }}</span>
                        {{ /if }}

                        {{ #if section.isRegistered }}
                            <btn class="course_section_remove" {{ action "unregisterSection" section }}>x</btn>
                        {{ else }}
                            {{ #unless section.isConflicting }}
                                <btn class="course_section_add" {{ action "registerSection" section }}>+</btn>
                            {{ /unless }}
                        {{ /if }}
                    </div>
                    {{ /each }}
                </section>
            {{ /each }}
        </div>
    </div>
</script>

<script type="text/x-handlebars" data-template-name="components/course-schedule-item">
    <div class="course_schedule_item">Course Name</div>
</script>
{% endverbatim %}

    <script>
        window.CSRF_TOKEN = '{{ csrf_token }}';
    </script>

    <script src="{{ STATIC_PREFIX }}wintersession/js/libs/jquery-1.11.1.min.js"></script>
    <script src="{{ STATIC_PREFIX }}wintersession/js/libs/handlebars-v1.3.0.js"></script>
    <script src="{{ STATIC_PREFIX }}wintersession/js/libs/bitapsearcher.js"></script>
    <script src="{{ STATIC_PREFIX }}wintersession/js/libs/ember.js"></script>
    <script src="{{ STATIC_PREFIX }}wintersession/js/libs/ember-data.js"></script>
    <script src="{{ STATIC_PREFIX }}wintersession/js/courses.js"></script>
{% endblock %}
